## 네트워크

* Network
    * 네트워킹 한다 = 통신한다
    * 통신을 위한 규약 --> 프로토콜
---
* VPN (Virtual Private Network)
    * 여러곳에 분산되어 있는 컴퓨터들을 연결하는 보안성이 높은 사설 네트워크를 만들거나 인터넷을 활용하여 원격지 간에 네트워크를 서로 연결하고 암호화 기술을 적용하여 안정적이고 보안성 높은 통신서비스를 제공하는 서비스
    * VPC와 VPC Gateway를 통해 On-Premise의 VPN장비와 Amazon Web Services 간의 VPN 을 연결 할 수 있음.
---
* VPC (Virtual Private Cloud)
    * AWS 클라우드에서 논리적으로 격리된 네트워크 공간을 할당하여 가상 네트워크에서 AWS 리소스를 이용할 수 있는 서비스를 제공.
    * 가상 네트워킹 환경을 제어할 수 있고 IPv4,IPv6 모두 사용하여 리소스와 애플리케이션에 안전하고 쉽게 액세스 가능.
    * 보안 그룹 및 네트워크 제어 목록을 포함한 다중 보안 계층을 활용하여 각 서브넷에서 EC2 인스턴스에 대한 액세스를 제어 할 수 있음.
---
* VPC의 구성요소
    * 프라이빗 IP 주소
        * 인터넷을 통해 연결 할 수 없는, VPC 내부에서만 사용할 수 있는 IP 주소
        * VPC에서 시작된 인스턴스 서브넷의 범위에서 자동으로 할당, 동일 네트워크에서 인스턴스 간 통신에 사용 할 수 있음.
        * 보조 프라이빗 IP 주소라는 추가 프라이빗 주소를 할당 할 수 있음.
    * 퍼블릭 IP 주소
        * 인터넷을 통해 연결 할 수 있는 IP 주소, 인스턴스와 인터넷 간의 통신을 위해 사용할 수 있음.
        * EC2 생성 시 옵션으로 퍼블릭 IP 주소의 사용 여부를 선택할 수 있음.
        * 인스턴스에서 퍼블릭 IP 주소를 수동으로 연결하거나 해제할 수 없음.
        * 인스턴스가 재부팅되면 새로운 퍼블릭 IP 주소가 할당됨.
    * 탄성 IP 주소
        * 동적 컴퓨팅을 위해 고안된 고정 퍼블릭 IP 주소.
        * VPC의 모든 인스턴스와 네트워크 인터페이스에 탄성 IP를 할당 할 수 있음.
        * 다른 인스턴스에 주소를 신속하게 다시 매칭하여 인스턴스 장애 조치를 수행할 수 있음.
        * 탄력적 IP 주소가 실행 중인 인스턴스와 연결되어 있지 않거나, 중지된 인스턴스 또는 분리된 네트워크 인터페이스와 연결되어 있는 경우
        시간당 요금이 부과됨.
        * 사용가능한 탄력적 IP 주소는 5개로 제한되며, 절약하기 위해 NAT 디바이스를 사용할 수 있음.
    * VPC 와 서브넷
        * VPC AWS 계정 사용자를 위한 전용의 `가상 네트워크`
        * AWS 클라우드에서 다른 가상 네트워크와 논리적으로 분리되어 있고, EC2 인스턴스와 같은 AWS 리소스를 VPC에서 실행 할 수 있음.
        * VPC 내부의 네트워크에서도 서비스 목적에 따라 IP Block 로 나누어 구분 할 수 있음.
            * 분리된 IP Block 의 모음을 `서브넷`이라고 함. ( == 네트워크상 서브넷과 동일한 개념)
        * 리전의 모든 가용 영역에 적용, 각 가용 영역에 하나 이상의 서브넷을 추가 할 수 있음.
            * 서브넷은 단일 가용 영역에서만 생성 가능, 여러 가용 영역으로 확장 할 수 없음.
    * VPC 와 서브넷사이즈
        * VPC 를 생성할 때, 사용하게 될 IP 주소의 범위를 지정하게 되는데 범위를 CIDR 블록 형태로 지정해야 함.
            * CIDR : Classless Inter-Domain Routing)
        * 256 개의 IP 주소를 지원 -> CIDR 블록을 각각 128개의 IP 주소를 지원하는 2개의 서브넷으로 나눌 수 있음.
    * 퍼블릿 서브넷과 프라이빗 서브넷
        * 퍼블릭 서브넷 : 서브넷 네트워크 트래픽이 인터넷 게이트웨이로 라우팅이 되는 서브넷
        * 프라이빗 서브넷 : 서브넷 네트워크 트래픽이 인터넷 게이트웨이로 라우팅 되지 않는 서브넷
        * EC2 인스턴스가 IP 를 통해 인터넷과 통신을 할 수 있게 하려면, 퍼블릭 IP 주소나 탄력적 IP 주소가 있어야함.
            * 웹 서버는 퍼블릭 서브넷에 생성하며, 인터넷으로 직접적으로 연결할 필요가 없고 보다 높은 보안성을 필요로 하는 DB 서버 등은 프라이빗 서브넷에 생성.
    * 라우팅 테이블
        * 서브넷 외부로 나가는 아웃바운드 트래픽에 대해 허용된 경로를 지정하는 라우팅 테이블이 연결되어 있어야함.
        * 생성된 서브넷은 자동으로 VPC의 기본 라우팅 테이블과 연결, 내용 변경 가능
        * 네트워크 패킷이 목적지 주소로 이용하기 위해 어떤 경로로 이동되어야 하는지 알려주는 나침반 개념.
            * 서브넷 간의 통신이나 VPC 간의 원활한 통신을 위해 라우팅 테이블을 이용.
---
* VPC의 주요서비스
    * 보안 그룹과 네트워크 액세스 제어 목록
        * IP와 PORT 기준으로 허용하거나 차단하는 서비스를 제공함
            * 보안 그룹과 네트워크 ACL이라 함.

                |구분|보안그룹|네트워크 ACL|
                |---|---|---|
                |서비스 범위|인스턴스 레벨에 적용|서브넷 레벨에 적용|
                |적용 정책|허용 규칙만 적용|허용 및 거부 규칙 적용|
                |구동 방식|규칙에 상관없이 반환 트래픽 허용|반환 트래픽이 별도로 허용되어야 함|
                |룰 검토/적용|해당 객체 내 모든 룰 검토|해당 객체 내 룰을 번호 순으로 처리|
                |적용 방법|인스턴스에 보안 그룹 추가 필요|연결된 서브넷에 모든 인스턴스 자동 적용됨|
    * VPC 피어링 연결
        * 피어링 연결은 비공개적으로 두 VPC 간에 트래픽을 라우팅할 수 있게 하기 위한 서로 다른 VPC 간의 네트워크 연결을 제공.
        * 동일한 네트워크에 속한 것과 같이 서로 다른 VPC의 인스턴스 간에 통신이 가능.
    * NAT 게이트웨이
        * Network Address Translation
        * 외부 네트워크에 알려진 것과 다른 IP 주소를 사용하는 내부 네트워크에서, 내부 IP 주소를 외부 IP 주소로 변환하는 작업을 수행하는 서비스.
        * NAT 게이트웨이는 프라이빗 서브넷 내에 있는 인스턴스를 인터넷 또는 다른 AWS 서비스에 연결하고, 외부망 또는 인터넷에서 해당 인스턴스에 연결하지 못하도록 구성하는데 사용.
        * 외부에 공개될 필요가 없는 경우 NAT 게이트웨이나 NAT 인스턴스를 사용.
            1. NAT 게이트웨이를 생성하기 위해 퍼블릭 서브넷을 지정
            2. NAT 게이트웨이와 연결할 탄력적 IP 주소 필요
            3. NAT 게이트웨이를 만들 후 인터넷 트래픽이 NAT 게이트웨이로 통신이 가능하도록 프라이빗 서브넷과 연결된 라우팅 테이블 업데이트
    * VPC 엔드포인트
        * 프라이빗 서브넷에 위치한 인스턴스는 인터넷과 연결되어 있는 S3와 같은 공용 리소스를 연결할 수 없음.
    * VPN 연결
        * 기본적으로 Amazon VPC 에서 서비스 되는 인스턴스는 On-Premise에 있는 서버나 IDC 내의 시스템과 통신할 수 없음.
            * 통신을 하기 위해서
                1. 가상의 프라이빗 게이트웨이 연결
                2. 사용자 지정 라우팅 테이블 생성
                3. 보안 그룹의 규칙 업데이트
                4. AWS 관리형 VPN 연결을 생성하여 VPC에서 원격의 네트워크에 접속 가능하도록 하이브리드 클라우드 환경 구성